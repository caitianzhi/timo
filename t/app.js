var indexApp=angular.module("indexApp",["ngRoute","ngRetina","ngTouch","apps.filters","apps.services","apps.controllers","apps.directives","analytics","templates","ng-translation"]),appsFilters=angular.module("apps.filters",[]),appsServices=angular.module("apps.services",["ngCookies"]),appsControllers=angular.module("apps.controllers",[]),appsDirectives=angular.module("apps.directives",[]);indexApp.config(["$locationProvider","$routeProvider","ngTranslationProvider",function(e,t,r){r.setDirectory("lang").setFilesSuffix(".json").langsFiles({cn:"cn"}).fallbackLanguage("cn"),t.when("/",{templateUrl:"view/html/home.html",controller:"HomeCtrl",pageClass:"home"}),t.when("/home",{redirectTo:"/"}),t.when("/instruction",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/instruction")}}),t.when("/payment",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/payment")}}),t.when("/service",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/service")}}),t.when("/delivery",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/delivery")}}),t.when("/storelist",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/storelist")}}),t.when("/about",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/about")}}),t.when("/contact",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/contact")}}),t.when("/agreement",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/agreement")}}),t.when("/privacy",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/privacy")}}),t.when("/insurance",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/insurance")}}),t.when("/repair",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/repair")}}),t.when("/cloud-terms",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/cloud-terms")}}),t.when("/cloudTerms",{redirectTo:"/cloud-terms"}),t.when("/osterms",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/osterms")}}),t.when("/appstore-terms",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/appstore-terms")}}),t.when("/appStoreTerms",{redirectTo:"/appstore-terms"}),t.when("/property",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/property")}}),t.when("/join",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/support/#/join")}}),t.when("/ifawards",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/special/#/ifawards")}}),t.when("/fudai",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/special/#/fudai")}}),t.when("/fudai-intro",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/special/#/fudai-intro")}}),t.when("/mobile-videolist",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/pr/#/videos")}}),t.when("/mobile-video/:id",{redirectTo:function(e,t,r){var n=t.substring(8);location.replace("http://www.smartisan.com/pr/#/"+n)}}),t.when("/overview",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/t1/#/overview")}}),t.when("/feature",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/t1/#/features")}}),t.when("/design",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/t1/#/design")}}),t.when("/os",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/t1/#/os")}}),t.when("/detail",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/t1/#/specs")}}),t.when("/pr/news-center",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/pr/#/news-center")}}),t.when("/pr/news-center/:archive",{redirectTo:function(e,t,r){var n=t.substring(3);location.replace("http://www.smartisan.com/pr/#"+n)}}),t.when("/video",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/pr/#/video/smartisant1")}}),t.when("/video/:id",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/pr/#"+t)}}),t.when("/pr/video",{redirectTo:function(e,t,r){location.replace("http://www.smartisan.com/pr/#/videos")}}),t.when("/pr/video/:id",{redirectTo:function(e,t,r){var n=t.substring(3);location.replace("http://www.smartisan.com/pr/#"+n)}}),t.when("/pr/news/:id",{redirectTo:function(e,t,r){var n=t.substring(9,19),o=n.match(/^20[0-9]{4}/);location.replace("http://www.smartisan.com/pr/#/news/"+o+"/"+n)}}),t.when("/pr/news/:archive/:id",{redirectTo:function(e,t,r){var n=t.substring(3);location.replace("http://www.smartisan.com/pr/#"+n)}}),t.when("/pr/pictures",{redirectTo:function(e,t,r){var n=t.substring(3);location.replace("http://www.smartisan.com/pr/#"+n)}}),t.when("/apps/:appName",{redirectTo:function(e,t,r){var n=t.substring(5);location.replace("http://www.smartisan.com/apps/#"+n)}}),t.when("/error/:id",{title:"Smartisan",templateUrl:"view/html/error.html",controller:"ErrorCtrl"}),t.otherwise({redirectTo:"/error/404"})}]),indexApp.run(["$rootScope","$route","$location","$timeout","$window","$anchorScroll","Utils","ngTranslation","$cookies","Language",function(e,t,r,n,o,i,a,c,s,l){l.init(),c.use(e.lang),e.$on("$routeChangeStart",function(t,r,n){e.loading=!0,e.moduleName="index"}),e.$on("$routeChangeSuccess",function(r,n,o){e.loading=!1,e.pageClass=t.current.pageClass})}]),appsServices.factory("Utils",["$rootScope","$q","$http","$location","$cookies",function(e,t,r,n,o){var i={};return i.truncateChars=function(e,t,r,n){if(e){var o=e.replace(/[\u4e00-\u9fa5\s]/g,"**").length,i=[],a=0;if(n){var c=$("<div></div>").html(e);e=c.text(),c=null}if(t>=o)return e;for(var s=0;o>s;s++){var l=e.charAt(s);if(a+=/[^\x00-\xff]/.test(l)?2:1,i.push(l),a>=t)break}return r?i.join("")+"...":i.join("")}return""},i.encodeUriQuery=function(e,t){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,t?"%20":"+")},i.toKeyValue=function(e){var t=this,r=[];return angular.forEach(e,function(e,n){angular.isArray(e)?angular.forEach(e,function(e){r.push(t.encodeUriQuery(n,!0)+(e===!0?"":"="+t.encodeUriQuery(e,!0)))}):r.push(t.encodeUriQuery(n,!0)+(e===!0?"":"="+t.encodeUriQuery(e,!0)))}),r.length?r.join("&"):""},i.shareWeibo=function(e,t,r,n){var o=e||$(".share-btn"),i=encodeURIComponent(location.href),a=r||"",c="http://service.weibo.com/share/share.php?appkey=",s=n||$(".share-weibo-cover").attr("src"),l=encodeURIComponent(this.truncateChars(a,232,!0)+"（分享自 @锤子科技）");c+="&title="+l,c+="&url="+i,s&&(c+="&pic="+encodeURIComponent(s)),o.attr("href",c)},i.setTitle=function(e,t){document.title="undefined"==typeof t?e:e+" - "+t},i.setKeywords=function(e){e&&""!==e&&$("meta[name='keywords']").attr({content:e})},i.setDescription=function(e){e&&""!==e&&$("meta[name='description']").attr({content:e})},i.setMobileTitle=function(e){var t="";"undefined"==typeof e.text?t='<span class="logo-pic"></span>':t+="undefined"==typeof e.url?e.text:'<a href="'+e.url+'">'+e.text+"</a>",$(".mobile-title").html(t)},i.setCrumbs=function(e){for(var t="",r=0;r<e.length;r++)t+="undefined"==typeof e[r].url?e[r].title:'<a href="'+e[r].url+'">'+e[r].title+"</a>",r+1<e.length&&(t+=" &gt; ");$(".header-crumbs").length?$(".header-crumbs").html(t):$(".breadcrumb").html(t)},i.setT1Crumbs=function(e,t){e&&$(".header-sub .breadcrumb").removeClass("hide");var r="";t&&(r+='<h2 class="phone-logo"></h2>'),r+='<ul class="t1Crumbs">';for(var n=e.currentPage,o=0;o<e.list.length;o++){var i="";n&&e.list[o].url.indexOf(n)>0&&(i="on"),r=r+'<li class="'+i+'"><a href="'+e.list[o].url+'">'+e.list[o].title+"</a></li>"}r+="</ul>",$(".breadcrumb").html(r)},i.openServiceWindow=function(){var e=decodeURIComponent(arguments[0]||"http://chat10.live800.com/live800/chatClient/chatbox.jsp?companyID=376704&lan=zh&configID=185120&jid=4594069570"),t=arguments[1]||"_blank",r=arguments[2]||800,n=arguments[3]||600,o="directories=no, titlebar=no, toolbar=no, location=no, status=no, menubar=no, scrollbars=no, resizable=no, top=200,left=200, width= "+r+", height="+n,i=arguments[4]||!0;window.open(e,t,o,i)},i.showMore=function(e,t){var r=e.height(),n=e.find("h3").outerHeight()+e.find("ul").outerHeight();n>r&&(t.css({display:"block"}),t.bind("click",function(){e.find(".feature-wrapper").css({height:"auto"}),t.hide()}))},i.isMobile=function(){var e=navigator.userAgent.toLowerCase(),t="ipad"==e.match(/ipad/i),r="iphone os"==e.match(/iphone os/i),n="midp"==e.match(/midp/i),o="rv:1.2.3.4"==e.match(/rv:1.2.3.4/i),i="ucweb"==e.match(/ucweb/i),a="android"==e.match(/android/i),c="windows ce"==e.match(/windows ce/i),s="windows mobile"==e.match(/windows mobile/i);return t||r||n||o||i||a||c||s?!0:!1},i.isWeixin=function(){var e=navigator.userAgent.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)?!0:!1},i.isMobileQQ=function(){var e=navigator.userAgent.toLowerCase();return"qq/"==e.match(/qq\//i)?!0:!1},i.isIphone=function(){var e=navigator.userAgent.toLowerCase();return"iphone"==e.match(/iphone/i)?!0:!1},i.isAndroid=function(){var e=navigator.userAgent.toLowerCase();return"android"==e.match(/android/i)?!0:!1},i.mobileGuide=function(e){function t(){a.show(),setTimeout(function(){var e=c>n.height()?c:n.height();a.css({height:e})},700),a.bind("click",function(){a.hide()})}var r=this,n=$(document.body),o=$("#download-android"),i=$("#download-iPhone"),a=$("#mobileGuide"),c=window.screen.availHeight;this.isWeixin()||this.isMobileQQ()||this.isIphone()||!i.attr("href")||!i.attr("href").match(/^http/)||$(".desc-download .for-iphone").attr("target","_blank"),this.isWeixin()&&(o.attr("href","javascript:void(0);"),o.bind("click",function(e){t(),a.find("img").hide(),r.isIphone()?a.find(".guide-iOS-download").show():a.find(".guide-android-download").show()})),location.href.match(/\QR_download/)?this.isAndroid()?this.isWeixin()||this.isMobileQQ()?(t(),a.find(".guide-android-download").show()):setTimeout(function(){location.href=o.attr("href")},2e3):this.isIphone()&&i.attr("href").match(/^http/)&&setTimeout(function(){location.href=i.attr("href")},2e3):location.href.match(/\QR_share/)&&(this.isWeixin()||this.isMobileQQ())&&(t(),this.isIphone()?a.find(".guide-iOS-share").show():this.isAndroid()&&a.find(".guide-android-share").show())},i.changeLangCookies=function(e){var t=e.target.href;-1===t.indexOf("en")?(o.put("lang","zh-CN",{path:"/",domain:"smartisan.com"}),o.put("language","zh-CN",{path:"/",domain:"smartisan.com"})):(o.put("lang","en-US",{path:"/",domain:"smartisan.com"}),o.put("language","en-US",{path:"/",domain:"smartisan.com"}))},i}]),appsControllers.controller("MainCtrl",["$scope","$rootScope","$http","$timeout","$location","$window","Account","Message","BaseInfo","Utils",function(e,t,r,n,o,i,a,c,s,l){$(window).on("message",c.handler),s.update(),e.login=function(){s.update().then(function(e){t.isLoggedIn=!0},function(e){a.login()})},e.logout=function(){a.logout()},e.register=function(){a.register()}}]),appsControllers.controller("HomeCtrl",["$scope","Utils","$http",function(e,t,r){t.setTitle("锤子科技官网"),$(".header-sub .breadcrumb").addClass("hide"),t.setCrumbs([{title:""}]),$(".header-sub .language-switch").removeClass("hide");var n=0,o=[".red",".orange",".yellow",".green",".cyan",".blue",".purple"],i=function(e){$(".phone .home, .phone .back").removeClass("active"),$(".phone "+o[e]).addClass("active"),n=++n%7,setTimeout(function(){i(n)},5e3)};i(n),r.post("http://www.smartisan.com/get/curtime").then(function(e){if(e&&e.data.curtime&&""!=e.data.curtime){var t=1e3*parseInt(e.data.curtime),r=new Date(2015,7,25,23,0,0).getTime();t>=r&&($("#live-end").css({display:"inline-block"}),$("#live-on").css({display:"none"}))}},function(e){})}]),appsControllers.controller("ErrorCtrl",["$scope","$timeout","Utils","$routeParams","$rootScope",function(e,t,r,n,o){function i(){if(e.errorId){if(e.second-=1,0==e.second){var r="";("en"==o.lang||"jp"==o.lang)&&(r=o.lang+"/"),location.href="http://www.smartisan.com/"+r}t(i,1e3)}}var a={cn:{"40x":"抱歉，您输入的地址有误，请稍后再试。","50x":"抱歉，服务器内部错误，请稍后再试。",503:"抱歉，服务器忙碌，请稍后再试。",title:"锤子科技官网",crumbs:"首页"},jp:{"40x":"申し訳ありません。このページは表示できません。時間を置いて再接続しください。","50x":"申し訳ありません。サーバーエラーです。時間を置いて再接続しください。",503:"申し訳ありません。アクセスが集中しているため、つながりにくくなっております。時間を置いて再接続しください。",title:"スマーティザンテクノロジーオフィシャルサイト",crumbs:"ホームページ"},en:{"40x":"The page you are looking for cannot be found.","50x":"The page you are looking for cannot be found.",503:"The page you are looking for cannot be found.",title:"Smartisan",crumbs:"Index"}},c=function(e){var t={errorId:404,errorStatus:a[o.lang]["40x"]};switch(e){case"402":t.errorStatus=a[o.lang]["40x"],t.errorId=402;break;case"403":t.errorStatus=a[o.lang]["40x"],t.errorId=403;break;case"404":t.errorStatus=a[o.lang]["40x"],t.errorId=404;break;case"500":t.errorStatus=a[o.lang]["50x"],t.errorId=500;break;case"502":t.errorStatus=a[o.lang]["50x"],t.errorId=502;break;case"503":t.errorStatus=a[o.lang][503],t.errorId=503;break;default:t.errorStatus=a[o.lang]["40x"],t.errorId=404}return t},s=n.id;e.errorId=c(s).errorId,e.errorStatus=c(s).errorStatus,e.second=10,r.setTitle(a[o.lang].title),r.setCrumbs([{title:a[o.lang].crumbs,url:"#/home"},{title:e.errorId}]),i()}]),appsServices.constant("Config",{baseUrl:"/index.php?r=",headconfig:{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}},regExp:{isMobile:/^1[3|4|5|7|8]\d{9}$/,isMail:/^[\w.%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,6}$/,isPassword:/^[\w\\\[\]\:\^\-~!@#$%&*()-+={}|;'",.\/<>?]{6,16}$/,isSafeUrl:/^(http|https)\:\/\/[a-zA-Z0-9\-\.]+\.(smartisan.com\b)(:[a-zA-Z0-9]*)?\/?([a-zA-Z0-9\-\._\?\,\'\/\\\+&amp;%\$#\=~])*$/,isIMEI:/^\d{15}$/,isMAC:/^([0-9a-fA-F]{2})(([\s:][0-9a-fA-F]{2}){5})$/}}).constant("ACCESS_LEVELS",{pub:1,user:2,cloud:3,alpha:4}),appsServices.factory("Message",["Account","User","BaseInfo",function(e,t,r){var n=function(n){var o=n.originalEvent;o.origin==e.config.origin&&("isLoggedIn"==o.data&&r.update(),"isRegistered"==o.data&&r.update(),"isLoggedOut"==o.data&&(e.close(),t.logout()),"dialogClose"==o.data&&e.close())};return{handler:n}}]),appsServices.factory("Account",["$window",function(e){var t={},r={wrapper:"body",origin:"https://account.smartisan.com",loginUrl:"https://account.smartisan.com/#/login/embed",logoutUrl:"https://account.smartisan.com/#/logout/embed",registerUrl:"https://account.smartisan.com/#/register/embed"},n=function(){if(!t.wrapper){var e=[];e.push('<div class="iframe-dialog" id="iframe-dialog">'),e.push('<div class="mask"></div>'),e.push('<iframe allowtransparency="true" src="" frameborder="0"></iframe>'),e.push("</div>"),t.wrapper=$(r.wrapper),t.wrapper.append(e.join(""))}t.mask=$("#iframe-dialog .mask"),t.iframe=$("#iframe-dialog iframe")},o=function(r,o){if("undefined"!=typeof r){n();var i=e.location.origin||e.location.protocol+"//"+e.location.hostname;t.iframe.attr("src",r+"?origin="+i),o||(t.mask.show(),t.iframe.addClass("show"))}},i=function(){t.iframe&&(t.mask.hide(),t.iframe.removeClass("show"),t.iframe.attr("src",""))},a=function(){o(r.loginUrl)},c=function(){o(r.logoutUrl,!0)},s=function(){o(r.registerUrl)};return{config:r,close:i,login:a,logout:c,register:s}}]),appsServices.factory("User",["$rootScope","$q","$http","$location","Config","ACCESS_LEVELS",function(e,t,r,n,o,i){var a={},c=!1,s=o.baseUrl,l=function(t){$.extend(a,t),c=!0,e.isLoggedIn=a.role>i.user?!0:!1},u=function(){var n=t.defer();return r.post(s+"account/user","",null).success(function(t){0==t.code?(l(t.data),e.isLoggedIn=!0,n.resolve(t)):(e.isLoggedIn=!1,n.reject(t))}).error(function(){n.reject("网络异常!")}),n.promise};return{getInfo:u,isInitial:function(){return c},isAuthorized:function(e){return a&&a.role>=e},set:l,isLoggedIn:function(){return a.uid?!0:!1},getUser:function(){return a},getId:function(){return a?a.uid:null},getName:function(){return a.name||""},getRole:function(){return a.role||null},getAvatarUrl:function(){return a.avatarUrl||""},logout:function(){a={},e.isLoggedIn=!1,e.$apply()}}}]),appsServices.factory("BaseInfo",["$q","User","Account",function(e,t,r){var n=function(){var n=e.defer();return t.getInfo().then(function(e){r.close(),n.resolve()},function(e){n.reject()}),n.promise};return{update:n}}]),appsServices.factory("Request",["$http","$q","Config","Utils",function(e,t,r,n){var o=r.baseUrl,i=r.headconfig;return{recruiting:function(r){var a=t.defer(),c=n.toKeyValue(r);return e.post(o+"recruit/create",c,i).success(function(e){a.resolve(e)}).error(function(){a.reject("网络异常!")}),a.promise},finderRecruiting:function(r){var a=t.defer(),c=n.toKeyValue(r);return e.post(o+"finder/create",c,i).success(function(e){a.resolve(e)}).error(function(){a.reject("网络异常!")}),a.promise}}}]),appsServices.factory("Language",["$rootScope","$cookies","$window","$location",function(e,t,r,n){var o=function(){e.lang="cn",e.langStatic=""};return{init:o}}]),appsDirectives.directive("changeLanguage",["$document",function(e){return{restrict:"A",link:function(t,r,n,o){r&&(r.on("click",function(e){var t=$(e.target).closest(".language-switch");return t.toggleClass("active"),!1}),e.on("click",function(e){var t=$(e.target);t.closest(".language-switch").is(".language-switch")||$(".language-switch").removeClass("active")}))}}}]).directive("showWeixinCode",["$document","Utils",function(e,t){return{restrict:"A",link:function(e,t,r,n){t&&t.find("a").on("click",function(){var e=$(this).parent(".weixin"),t=e.find(".qrcode");if(t.is(":hidden")){e.addClass("hold");var r=$(window).height()/2;t.css({bottom:r+"px"}),t.fadeIn(100),setTimeout(function(){e.find(".mask").one("click",function(){e.removeClass("hold"),t.fadeOut(300),e.removeClass("hold")}),e.find(".close-btn").one("click",function(){e.removeClass("hold"),t.fadeOut(300),e.removeClass("hold")})})}})}}}]).directive("openServiceWindow",["$document","Utils",function(e,t){return{restrict:"A",link:function(e,r,n,o){r&&r.on("click",function(e){e.preventDefault(),t.openServiceWindow()})}}}]).directive("mobileNavShow",["$document",function(e){return{restrict:"A",link:function(e,t,r,n){t&&(t.on("click",function(e){return $(".wrapper").removeClass("moblie-quick-nav"),$(".wrapper").toggleClass("moblie-show-nav"),!1}),$(document).on("click",function(e){$(".wrapper").removeClass("moblie-show-nav"),$(".wrapper").addClass("moblie-quick-nav")}))}}}]).directive("mobileNavSticky",["$document",function(e){return{restrict:"A",link:function(e,t,r,n){t&&$(window).on("scroll",function(){$("body").scrollTop()>45?(t.addClass("sticky"),$(".wrapper").removeClass("moblie-show-nav"),$(".wrapper").addClass("moblie-quick-nav")):$("body").scrollTop()>85?($(".wrapper").removeClass("moblie-show-nav"),$(".wrapper").addClass("moblie-quick-nav"),t.addClass("sticky")):t.removeClass("sticky")})}}}]).directive("backTop",["$document",function(e){return{restrict:"A",link:function(e,t,r,n){t&&($(window).on("scroll",function(){$(window).scrollTop()>600?t.addClass("active"):t.removeClass("active")}),t.on("click",function(){$("html,body").animate({scrollTop:$("body").offset().top},{queue:!1},500)}))}}}]).directive("accountReservation",["$document","Utils",function(e,t){return{restrict:"A",link:function(e,r,n,o){r&&t.isMobile()&&r.on("click",function(){$(this).hasClass("active")?$(this).removeClass("active"):$(this).addClass("active")})}}}]).directive("routeChangeResetHeader",[function(){return{restrict:"A",controller:["$element","$rootScope","Utils",function(e,t,r){t.$on("$routeChangeStart",function(){r.setMobileTitle({text:'<span class="logo-pic"></span>'}),e.find(".nav-main li").removeClass("active"),$(".wrapper").addClass("moblie-quick-nav"),$(".wrapper").removeClass("moblie-show-nav"),e.find(".header-sub .breadcrumb").removeClass("hide"),e.find(".header-sub .language-switch").addClass("hide"),e.find(".header-sub .language-switch").removeClass("active")})}]}}]).directive("routeChangeResetFooter",[function(){return{restrict:"A",controller:["$element","$rootScope",function(e,t){t.$on("$routeChangeStart",function(){e.find(".language-switch").removeClass("active")})}]}}]).directive("trackerzClick",["$document",function(e){return{restrict:"A",link:function(e,t,r,n){$(t).click(function(e){var t=r.trackerzClick;MLTrackerz.track({type:"event",action:t})})}}}]);
